<!---Ini update data ke supabase-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-GCMS 4.0</title>

    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

    <!-- font awesome cdn link  -->
    <link rel="stylesheet" href="">

    <!-- custom css file link  -->
    <link rel="stylesheet" href="Style-eGCMS-RegisAdmin.css">
    

</head>
<body>
    
<!-- header section starts      -->

<header>

    <a href="" class="logo"><i class=""></i> e-GCMS 4.0</a>

    <nav class="navbar">
        <a href="e-GCMS.html">home</a>
        <a href="e-GCMS.html#about">about us</a>
        <a href="e-GCMS.html#stunting">stunting</a>
        <a href="e-GCMS_Login.html">login</a>
    </nav>


</header>

<!-- header section ends-->

<!-- search form  -->

<form action="" id="search-form">
    <input type="search" placeholder="search here..." name="" id="search-box">
    <label for="search-box" class="fas fa-search"></label>
    <i class="fas fa-times" id="close"></i>
</form>

<!-- home section starts  -->

<section class="home" id="home">
    
        <div class="content">
            <h3>Daftarkan Posyandu Anda!</h3>
            <p>Menu Pendaftaran e-GCMS 4.0</p>

            <form action="" id="regis-form">

                <div class="inputBox">
                    <div class="input">
                        <span>Nama Posyandu</span>
                        <input type="text" placeholder="Nama Posyandu" id="nama_posyandu" name="nama_posyandu" required/>
                    </div>
                </div>

            <div class="inputBox">
                <div class="input">
                    <span>Username</span>
                    <input type="text" placeholder="Username" id="username_admin" name="username_admin" required/>
                </div>
            </div>

            <div class="inputBox">
                <div class="input">
                    <span>Alamat Posyandu</span>
                    <input type="text" placeholder="Alamat Posyandu" id="alamat_posyandu" name="alamat_posyandu" required/>
                </div>
            </div>
            
            <div class="inputBox">
                <div class="input">
                    <span>Password</span>
                    <input type="password" placeholder="Password" id="pass_admin" name="pass_admin" required/>
                </div>
            </div>

            <div class="button">
                <button class="btn" type="submit" id="sub_btn">Daftar</button>
            </div>

            <div class="button">
                <a href="e-GCMS_LoginAdmin.html" class="btn">Sudah memiliki akun?</a>
            </div>
            
    
        </form>

        </div>

        </section>
</body>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
    const { createClient } = supabase
    supabase = createClient("https://ycukwhswwfyarvjkmjky.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InljdWt3aHN3d2Z5YXJ2amttamt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NjQ4NjQyMzksImV4cCI6MTk4MDQ0MDIzOX0.804hR33Tk2zVRtoqCjHHO-jTAeLWBEd95BlaAyV4kbU")

    const form = document.querySelector("#regis-form")
    form.addEventListener('submit', async (event) =>{
        event.preventDefault()

        const formInputs = form.querySelectorAll('input, select, textarea')

        let submision = {}

        formInputs.forEach(element => {
            const {value, name} = element
            if (value) {
                submision[name] = value
            }
        })

        const {error, data } = await supabase.from('admin').insert([submision])

        if (error) {
            alert('Registrasi gagal!')
        } else {
            alert('Akun berhasil dibuat.')
            window.location.assign("e-GCMS_LoginAdmin.html");
        }

        formInputs.forEach(element => element.value = '')

    })
</script>
</html>